# 花卉管理系统 - 完整项目说明书

## 目录
1. [项目概述](#项目概述)
2. [技术架构](#技术架构)
3. [项目结构](#项目结构)
4. [核心功能模块](#核心功能模块)
5. [数据库设计](#数据库设计)
6. [API接口文档](#api接口文档)
7. [环境配置](#环境配置)
8. [部署指南](#部署指南)
9. [使用说明](#使用说明)
10. [开发规范](#开发规范)
11. [常见问题](#常见问题)

---

## 项目概述

### 项目简介
花卉管理系统是一个基于 **Spring Boot + Vue.js** 前后端分离架构的企业级花卉信息管理系统。本项目基于成熟的若依(RuoYi)框架进行深度二次开发，实现了花卉信息管理、花卉购买、订单管理、库存管理及数据统计等核心业务流程的信息化与自动化，有效提升了花卉管理的效率和准确性。

### 项目特点
- **前后端分离**：前端Vue.js负责页面渲染与交互，后端Spring Boot提供RESTful API，耦合度低，易于维护
- **权限控制**：基于RBAC（用户-角色-权限）模型，实现精细到按钮级别的访问控制
- **图片管理**：支持花卉图片上传、预览和管理，提升用户体验
- **性能优化**：集成Redis缓存，提升热点数据（如花卉分类、用户信息）查询速度
- **代码生成**：内置代码生成器，可快速生成CRUD代码，提高开发效率
- **定时任务**：集成Quartz定时任务框架，支持任务调度管理

### 版本信息
- **项目版本**：1.0.0
- **作者**: 114514
- **开发时间**：2025年
- **基础框架**：若依(RuoYi) 3.8.5

---

## 技术架构

### 后端技术栈
| 技术 | 版本 | 说明 |
|------|------|------|
| Spring Boot | 2.5.14 | 核心框架 |
| Spring Security | - | 安全框架 |
| MyBatis | - | ORM框架 |
| MySQL | 5.7+ | 关系型数据库 |
| Redis | 5+ | 缓存数据库 |
| Maven | 3.6+ | 项目构建工具 |
| Druid | 1.2.16 | 数据库连接池 |
| JWT | 0.9.1 | Token认证 |
| Swagger | 3.0.0 | API文档 |
| Quartz | - | 定时任务 |
| PageHelper | 1.4.6 | 分页插件 |

### 前端技术栈
| 技术 | 版本 | 说明 |
|------|------|------|
| Vue.js | 2.6.12 | 前端框架 |
| Element-UI | 2.15.12 | UI组件库 |
| Axios | 0.24.0 | HTTP客户端 |
| Vue Router | 3.4.9 | 路由管理 |
| Vuex | 3.6.0 | 状态管理 |
| ECharts | 5.4.0 | 数据可视化 |
| Node.js | 14+ | 运行环境 |

### 开发工具
- **IDE**：IntelliJ IDEA / Eclipse
- **数据库管理**：Navicat / DBeaver
- **版本控制**：Git
- **API测试**：Postman / Swagger UI

---

## 项目结构

### 后端模块结构
```
tang.github.io/
├── ruoyi-admin/              # 启动模块（主入口）
│   ├── src/main/java/com/ruoyi/
│   │   └── RuoYiApplication.java    # 启动类
│   └── src/main/resources/
│       ├── application.yml          # 主配置文件
│       └── application-druid.yml    # 数据源配置
│
├── ruoyi-common/             # 通用工具模块
│   └── src/main/java/com/ruoyi/common/
│       ├── annotation/              # 自定义注解
│       ├── config/                  # 配置类
│       ├── core/                    # 核心类
│       ├── enums/                   # 枚举类
│       ├── exception/               # 异常处理
│       ├── json/                    # JSON处理
│       ├── utils/                   # 工具类
│       └── xss/                     # XSS过滤
│
├── ruoyi-framework/          # 核心框架模块
│   └── src/main/java/com/ruoyi/framework/
│       ├── aspectj/                 # AOP切面
│       ├── config/                  # 框架配置
│       ├── datasource/              # 数据源配置
│       ├── interceptor/              # 拦截器
│       ├── security/                 # 安全配置
│       ├── web/                     # Web配置
│       └── websocket/               # WebSocket
│
├── ruoyi-system/             # 系统管理模块
│   └── src/main/java/com/ruoyi/system/
│       ├── domain/                  # 实体类
│       ├── mapper/                  # 数据访问层
│       └── service/                 # 业务逻辑层
│
├── ruoyi-pill/               # 花卉业务模块（核心业务）
│   └── src/main/java/com/ruoyi/pill/
│       ├── domain/                  # 实体类
│       │   ├── Flower.java          # 花卉信息
│       │   ├── FlowerOrder.java    # 订单信息
│       │   ├── FlowerAllOrder.java # 全部订单
│       │   ├── FlowerDashboardVo.java # 数据统计
│       │   └── BuyRequest.java     # 购买请求
│       ├── mapper/                  # 数据访问层
│       │   ├── FlowerMapper.java
│       │   ├── FlowerOrderMapper.java
│       │   └── FlowerDashboardMapper.java
│       └── service/                 # 业务逻辑层
│           ├── IFlowerService.java
│           ├── IFlowerOrderService.java
│           └── IFlowerDashboardService.java
│
├── ruoyi-quartz/             # 定时任务模块
│   └── src/main/java/com/ruoyi/quartz/
│
├── ruoyi-generator/          # 代码生成模块
│   └── src/main/resources/
│       ├── generator.yml            # 生成器配置
│       └── vm/                      # 模板文件
│
└── sql/                      # 数据库脚本
    ├── db_pss.sql            # 数据库初始化脚本
    └── flower_table.sql      # 花卉表结构脚本
```

### 前端模块结构
```
ruoyi-ui/
├── public/                   # 静态资源
│   ├── index.html           # 入口HTML
│   └── favicon.ico          # 网站图标
│
├── src/
│   ├── api/                 # API接口
│   │   ├── pill/           # 花卉相关接口
│   │   │   ├── flower.js          # 花卉信息接口
│   │   │   ├── flowerClient.js    # 花卉购买接口
│   │   │   ├── flowerOrder.js     # 订单接口
│   │   │   ├── flowerAllOrder.js  # 全部订单接口
│   │   │   └── flowerDashboard.js # 数据统计接口
│   │   ├── system/         # 系统管理接口
│   │   └── monitor/        # 监控接口
│   │
│   ├── assets/             # 资源文件
│   │   ├── icons/          # 图标
│   │   ├── images/         # 图片
│   │   └── styles/         # 样式文件
│   │
│   ├── components/         # 公共组件
│   │   ├── Breadcrumb/     # 面包屑
│   │   ├── Pagination/     # 分页
│   │   ├── ImageUpload/    # 图片上传
│   │   └── ImagePreview/   # 图片预览
│   │
│   ├── directive/          # 自定义指令
│   ├── layout/             # 布局组件
│   ├── plugins/            # 插件
│   ├── router/             # 路由配置
│   ├── store/              # Vuex状态管理
│   ├── utils/              # 工具函数
│   │
│   └── views/              # 页面视图
│       ├── pill/           # 花卉管理页面
│       │   ├── flower/      # 花卉信息
│       │   ├── flowerClient/ # 花卉购买
│       │   ├── flowerOrder/  # 订单管理
│       │   ├── flowerAllOrder/ # 全部订单
│       │   ├── flowerInventory/ # 库存管理
│       │   ├── flowerAlerts/   # 库存预警
│       │   └── flowerReports/  # 数据报表
│       ├── system/         # 系统管理页面
│       ├── monitor/        # 系统监控页面
│       └── tool/           # 系统工具页面
│
├── package.json            # 依赖配置
├── vue.config.js           # Vue配置
└── babel.config.js         # Babel配置
```

---

## 核心功能模块

### 1. 系统管理模块（ruoyi-system）

#### 1.1 用户管理
- 用户信息的增删改查
- 用户状态管理（启用/禁用）
- 用户密码重置
- 用户角色分配
- 用户部门分配

#### 1.2 角色管理
- 角色的增删改查
- 角色权限分配
- 角色菜单权限配置
- 数据权限设置

#### 1.3 菜单管理
- 菜单树形结构管理
- 菜单权限配置
- 按钮权限控制
- 菜单图标设置

#### 1.4 部门管理
- 部门树形结构管理
- 部门负责人设置
- 部门排序

#### 1.5 岗位管理
- 岗位信息管理
- 岗位状态管理

#### 1.6 字典管理
- 字典类型管理
- 字典数据管理
- 字典缓存

#### 1.7 参数设置
- 系统参数配置
- 参数缓存管理

#### 1.8 通知公告
- 公告发布
- 公告管理

#### 1.9 操作日志
- 操作日志记录
- 日志查询
- 日志导出

#### 1.10 登录日志
- 登录记录
- 登录统计

### 2. 花卉业务模块（ruoyi-pill）

#### 2.1 花卉信息管理
**功能描述**：管理花卉的基本信息、库存、价格、图片等

**主要字段**：
- 花卉ID（flower_id）
- 花卉名称（flower_name）
- 花卉编码（flower_code）
- 花卉类型（flower_type）：0=观花类，1=观叶类，2=观果类，3=多肉类
- 颜色（color）
- 花期（flowering_period）
- 价格（price）
- 库存量（num）
- 预警值（warn_value）
- 单位（unit）
- 图片（image）
- 状态（status）：0=正常，1=停用

**功能特性**：
- 花卉信息的增删改查
- 花卉编码唯一性校验
- 图片上传和管理
- 库存实时更新
- 库存预警提醒
- 花卉信息导出
- 多条件组合查询

**相关文件**：
- 实体类：`Flower.java`
- 控制器：`FlowerController.java`
- 服务类：`IFlowerService.java`
- 前端页面：`pill/flower/index.vue`
- API接口：`api/pill/flower.js`

#### 2.2 花卉购买（商城）
**功能描述**：用户端花卉购买功能

**功能特性**：
- 花卉列表展示（带图片）
- 花卉搜索和筛选
- 花卉分类筛选（按类型）
- 购买对话框
  - 数量选择
  - 收货地址选择
  - 金额计算
- 库存校验
- 下单购买
- 价格计算

**相关文件**：
- 控制器：`FlowerClientController.java`
- 服务类：`IFlowerClientService.java`
- 前端页面：`pill/flowerClient/index.vue`
- API接口：`api/pill/flowerClient.js`

#### 2.3 订单管理
**功能描述**：管理用户的花卉购买订单

**主要字段**：
- 订单ID（order_id）
- 用户ID（user_id）
- 花卉ID（flower_id）
- 购买数量（quantity）
- 总金额（total_price）
- 订单状态（status）：PAID=已支付，COMPLETED=已完成，CANCELLED=已取消
- 下单时间（create_time）
- 更新时间（update_time）

**功能特性**：
- 订单创建
- 订单查询（我的订单）
- 订单状态管理
- 订单取消
- 订单完成
- 订单统计

**相关文件**：
- 实体类：`FlowerOrder.java`
- 控制器：`FlowerOrderController.java`
- 服务类：`IFlowerOrderService.java`
- 前端页面：`pill/flowerOrder/index.vue`
- API接口：`api/pill/flowerOrder.js`

#### 2.4 全部订单管理
**功能描述**：管理员查看所有用户的订单信息

**功能特性**：
- 全部订单查询
- 订单状态筛选
- 订单详情查看
- 订单统计
- 用户信息关联

**相关文件**：
- 实体类：`FlowerAllOrder.java`
- 控制器：`FlowerAllOrderController.java`
- 服务类：`IFlowerAllOrderService.java`
- 前端页面：`pill/flowerAllOrder/index.vue`
- API接口：`api/pill/flowerAllOrder.js`

#### 2.5 库存管理
**功能描述**：花卉库存的实时监控和管理

**功能特性**：
- 库存查询
- 库存预警
- 库存统计
- 库存历史记录
- 库存变动记录

**相关文件**：
- 前端页面：`pill/flowerInventory/index.vue`
- API接口：`api/pill/flower.js`（复用）

#### 2.6 库存预警
**功能描述**：当花卉库存低于预警值时进行提醒

**功能特性**：
- 预警花卉列表
- 预警级别设置
- 预警通知
- 预警统计

**相关文件**：
- 前端页面：`pill/flowerAlerts/index.vue`
- API接口：`api/pill/flower.js`（复用）

#### 2.7 数据统计报表
**功能描述**：花卉销售、库存等数据的可视化统计

**功能特性**：
- 销售统计
- 库存统计
- 订单统计
- 花卉类型统计
- 数据图表展示（ECharts）
- 数据导出

**相关文件**：
- 实体类：`FlowerDashboardVo.java`
- 控制器：`FlowerDashboardController.java`
- 服务类：`IFlowerDashboardService.java`
- 前端页面：`pill/flowerReports/index.vue`
- API接口：`api/pill/flowerDashboard.js`

### 3. 系统监控模块

#### 3.1 在线用户
- 在线用户列表
- 强制下线

#### 3.2 定时任务
- 任务管理
- 任务执行日志
- 任务调度

#### 3.3 数据监控
- 数据源监控
- SQL监控
- 慢SQL查询

#### 3.4 服务监控
- 服务器信息
- JVM信息
- 系统信息

#### 3.5 缓存监控
- Redis缓存信息
- 缓存管理

### 4. 系统工具模块

#### 4.1 代码生成
- 数据库表选择
- 代码生成配置
- 代码预览
- 代码下载

#### 4.2 系统接口
- Swagger API文档
- 接口测试

---

## 数据库设计

### 核心业务表

#### 1. 花卉信息表（flower）
```sql
CREATE TABLE `flower` (
  `flower_id` bigint NOT NULL AUTO_INCREMENT COMMENT '花卉ID',
  `flower_name` varchar(50) DEFAULT NULL COMMENT '花卉名称',
  `flower_code` varchar(50) DEFAULT NULL COMMENT '花卉编码',
  `flower_type` char(1) DEFAULT NULL COMMENT '花卉类型：0=观花类,1=观叶类,2=观果类,3=多肉类',
  `color` varchar(20) DEFAULT NULL COMMENT '颜色',
  `flowering_period` varchar(50) DEFAULT NULL COMMENT '花期',
  `price` int DEFAULT NULL COMMENT '价格',
  `num` int DEFAULT NULL COMMENT '库存量',
  `warn_value` int DEFAULT NULL COMMENT '预警值',
  `unit` varchar(10) DEFAULT NULL COMMENT '单位',
  `image` varchar(500) DEFAULT NULL COMMENT '图片路径',
  `status` char(1) DEFAULT '0' COMMENT '状态：0=正常,1=停用',
  `create_by` varchar(50) DEFAULT NULL COMMENT '创建者',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  `update_by` varchar(50) DEFAULT NULL COMMENT '更新者',
  `update_time` datetime DEFAULT NULL COMMENT '更新时间',
  `remark` varchar(500) DEFAULT NULL COMMENT '备注',
  PRIMARY KEY (`flower_id`),
  UNIQUE KEY `uk_flower_code` (`flower_code`),
  KEY `idx_flower_type` (`flower_type`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3 COMMENT='花卉信息表';
```

#### 2. 花卉订单表（flower_order）
```sql
CREATE TABLE `flower_order` (
  `order_id` bigint NOT NULL AUTO_INCREMENT COMMENT '订单ID',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `flower_id` bigint NOT NULL COMMENT '花卉ID',
  `quantity` int NOT NULL DEFAULT '1' COMMENT '购买数量',
  `total_price` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '总金额',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '下单时间',
  `status` varchar(20) NOT NULL DEFAULT 'PAID' COMMENT '订单状态：PAID=已支付,COMPLETED=已完成,CANCELLED=已取消',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '状态更新时间',
  PRIMARY KEY (`order_id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_flower_id` (`flower_id`),
  KEY `idx_status` (`status`),
  KEY `idx_create_time` (`create_time`),
  CONSTRAINT `flower_order_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `sys_user` (`user_id`),
  CONSTRAINT `flower_order_ibfk_2` FOREIGN KEY (`flower_id`) REFERENCES `flower` (`flower_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='花卉订单表';
```

#### 3. 字典数据表（花卉类型）
```sql
-- 花卉类型字典
INSERT INTO `sys_dict_type` (`dict_id`, `dict_name`, `dict_type`, `status`, `create_by`, `create_time`, `remark`) 
VALUES (100, '花卉类型', 'flower_type', '0', 'admin', NOW(), '花卉类型字典');

INSERT INTO `sys_dict_data` (`dict_code`, `dict_sort`, `dict_label`, `dict_value`, `dict_type`, `css_class`, `list_class`, `is_default`, `status`, `create_by`, `create_time`, `remark`) VALUES
(1, 1, '观花类', '0', 'flower_type', '', 'primary', 'N', '0', 'admin', NOW(), '观花类花卉'),
(2, 2, '观叶类', '1', 'flower_type', '', 'success', 'N', '0', 'admin', NOW(), '观叶类花卉'),
(3, 3, '观果类', '2', 'flower_type', '', 'warning', 'N', '0', 'admin', NOW(), '观果类花卉'),
(4, 4, '多肉类', '3', 'flower_type', '', 'info', 'N', '0', 'admin', NOW(), '多肉类植物');
```

### 系统管理表

#### 用户表（sys_user）
- 用户基本信息
- 用户角色关联
- 用户余额（用于购买）

#### 角色表（sys_role）
- 角色信息
- 角色权限关联

#### 菜单表（sys_menu）
- 菜单树形结构
- 菜单权限

#### 部门表（sys_dept）
- 部门树形结构

#### 字典表（sys_dict_type、sys_dict_data）
- 字典类型和字典数据

#### 操作日志表（sys_oper_log）
- 操作日志记录

#### 登录日志表（sys_logininfor）
- 登录记录

---

## API接口文档

### 1. 花卉信息管理接口

#### 1.1 查询花卉列表
- **接口地址**：`GET /pill/flower/list`
- **接口描述**：分页查询花卉信息列表
- **请求参数**：
  ```json
  {
    "pageNum": 1,
    "pageSize": 10,
    "flowerName": "玫瑰",
    "flowerCode": "FL001",
    "flowerType": "0",
    "color": "红色",
    "status": "0"
  }
  ```
- **响应示例**：
  ```json
  {
    "code": 200,
    "msg": "查询成功",
    "rows": [
      {
        "flowerId": 1,
        "flowerName": "玫瑰",
        "flowerCode": "FL001",
        "flowerType": "0",
        "color": "红色",
        "floweringPeriod": "全年",
        "price": 50,
        "num": 100,
        "warnValue": 20,
        "unit": "束",
        "image": "/profile/upload/2025/01/01/rose.jpg",
        "status": "0",
        "createTime": "2025-01-01 10:00:00"
      }
    ],
    "total": 100
  }
  ```

#### 1.2 查询花卉详情
- **接口地址**：`GET /pill/flower/{flowerId}`
- **接口描述**：根据ID查询花卉详细信息
- **路径参数**：`flowerId` - 花卉ID
- **响应示例**：
  ```json
  {
    "code": 200,
    "msg": "操作成功",
    "data": {
      "flowerId": 1,
      "flowerName": "玫瑰",
      "flowerCode": "FL001",
      "flowerType": "0",
      "color": "红色",
      "floweringPeriod": "全年",
      "price": 50,
      "num": 100,
      "warnValue": 20,
      "unit": "束",
      "image": "/profile/upload/2025/01/01/rose.jpg",
      "status": "0"
    }
  }
  ```

#### 1.3 新增花卉
- **接口地址**：`POST /pill/flower`
- **接口描述**：新增花卉信息
- **请求参数**：
  ```json
  {
    "flowerName": "康乃馨",
    "flowerCode": "FL002",
    "flowerType": "0",
    "color": "粉色",
    "floweringPeriod": "全年",
    "price": 30,
    "num": 150,
    "warnValue": 30,
    "unit": "束",
    "image": "/profile/upload/2025/01/01/carnation.jpg",
    "status": "0",
    "remark": "粉色康乃馨"
  }
  ```
- **响应示例**：
  ```json
  {
    "code": 200,
    "msg": "操作成功"
  }
  ```

#### 1.4 修改花卉
- **接口地址**：`PUT /pill/flower`
- **接口描述**：修改花卉信息
- **请求参数**：同新增接口，需包含`flowerId`

#### 1.5 删除花卉
- **接口地址**：`DELETE /pill/flower/{flowerIds}`
- **接口描述**：删除花卉信息（支持批量删除）
- **路径参数**：`flowerIds` - 花卉ID数组，多个用逗号分隔

#### 1.6 导出花卉信息
- **接口地址**：`POST /pill/flower/export`
- **接口描述**：导出花卉信息为Excel文件
- **请求参数**：同查询列表接口

### 2. 花卉购买接口

#### 2.1 查询可购买花卉列表
- **接口地址**：`GET /pill/flowerClient/list`
- **接口描述**：查询可购买的花卉列表（仅显示有库存且状态正常的花卉）
- **请求参数**：
  ```json
  {
    "pageNum": 1,
    "pageSize": 10,
    "flowerName": "玫瑰",
    "flowerType": "0"
  }
  ```
- **响应示例**：
  ```json
  {
    "code": 200,
    "msg": "查询成功",
    "rows": [
      {
        "flowerId": 1,
        "flowerName": "玫瑰",
        "flowerCode": "FL001",
        "price": 50,
        "num": 100,
        "image": "/profile/upload/2025/01/01/rose.jpg"
      }
    ],
    "total": 50
  }
  ```

#### 2.2 购买花卉
- **接口地址**：`POST /pill/flowerClient/buy`
- **接口描述**：购买花卉，创建订单并扣减库存
- **请求参数**：
  ```json
  [
    {
      "flowerId": 1,
      "flowerName": "玫瑰",
      "quantity": 2,
      "price": 50
    }
  ]
  ```
- **响应示例**：
  ```json
  {
    "code": 200,
    "msg": "购买成功"
  }
  ```

### 3. 订单管理接口

#### 3.1 查询我的订单
- **接口地址**：`GET /pill/flowerOrder/list`
- **接口描述**：查询当前用户的订单列表
- **请求参数**：
  ```json
  {
    "pageNum": 1,
    "pageSize": 10,
    "status": "PAID"
  }
  ```
- **响应示例**：
  ```json
  {
    "code": 200,
    "msg": "查询成功",
    "rows": [
      {
        "orderId": 1,
        "flowerId": 1,
        "flowerName": "玫瑰",
        "flowerCode": "FL001",
        "quantity": 2,
        "unitPrice": 50.00,
        "totalPrice": 100.00,
        "status": "PAID",
        "createTime": "2025-01-01 10:00:00"
      }
    ],
    "total": 10
  }
  ```

#### 3.2 取消订单
- **接口地址**：`PUT /pill/flowerOrder/cancel/{orderId}`
- **接口描述**：取消订单，恢复库存
- **路径参数**：`orderId` - 订单ID

#### 3.3 完成订单
- **接口地址**：`PUT /pill/flowerOrder/complete/{orderId}`
- **接口描述**：完成订单
- **路径参数**：`orderId` - 订单ID

### 4. 全部订单管理接口

#### 4.1 查询全部订单
- **接口地址**：`GET /pill/flowerAllOrder/list`
- **接口描述**：管理员查询所有用户的订单
- **请求参数**：
  ```json
  {
    "pageNum": 1,
    "pageSize": 10,
    "status": "PAID",
    "userName": "admin",
    "flowerName": "玫瑰"
  }
  ```
- **响应示例**：
  ```json
  {
    "code": 200,
    "msg": "查询成功",
    "rows": [
      {
        "orderId": 1,
        "userId": 1,
        "userName": "admin",
        "flowerId": 1,
        "flowerName": "玫瑰",
        "flowerCode": "FL001",
        "quantity": 2,
        "totalPrice": 100.00,
        "status": "PAID",
        "createTime": "2025-01-01 10:00:00"
      }
    ],
    "total": 100
  }
  ```

### 5. 数据统计接口

#### 5.1 获取统计数据
- **接口地址**：`GET /pill/flowerDashboard/statistics`
- **接口描述**：获取花卉销售、库存等统计数据
- **响应示例**：
  ```json
  {
    "code": 200,
    "msg": "操作成功",
    "data": {
      "totalFlowers": 100,
      "todayOrders": 10,
      "lowInventory": 5,
      "totalSales": 5000.00,
      "totalInventory": 1000
    }
  }
  ```

### 6. 图片上传接口

#### 6.1 上传图片
- **接口地址**：`POST /common/upload`
- **接口描述**：上传花卉图片
- **请求类型**：`multipart/form-data`
- **请求参数**：`file` - 图片文件
- **响应示例**：
  ```json
  {
    "code": 200,
    "msg": "操作成功",
    "fileName": "/profile/upload/2025/01/01/rose.jpg",
    "url": "http://localhost:8080/profile/upload/2025/01/01/rose.jpg"
  }
  ```

---

## 环境配置

### 开发环境要求

#### 后端环境
- **JDK**：1.8 或以上版本
- **Maven**：3.6 或以上版本
- **MySQL**：5.7 或以上版本
- **Redis**：5.0 或以上版本
- **IDE**：IntelliJ IDEA 或 Eclipse

#### 前端环境
- **Node.js**：14.0 或以上版本
- **npm**：6.0 或以上版本
- **IDE**：WebStorm 或 VS Code

### 配置文件说明

#### 后端配置（application.yml）
```yaml
# 项目相关配置
ruoyi:
  name: RuoYi
  version: 3.8.5
  copyrightYear: 2025
  demoEnabled: true
  profile: D:/ruoyi/uploadPath  # 文件上传路径（图片存储路径）
  addressEnabled: false
  captchaType: math  # 验证码类型

# 服务器配置
server:
  port: 11451
  servlet:
    context-path: /

# Spring配置
spring:
  profiles: 
    active: druid
  # Redis配置
  redis:
    host: localhost
    port: 6379
    database: 0
    password: 123456
    timeout: 10s
  # 文件上传配置
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 20MB

# Token配置
token:
  header: Authorization
  secret: abcdefghijklmnopqrstuvwxyz
  expireTime: 30  # 令牌有效期（分钟）

# MyBatis配置
mybatis:
  typeAliasesPackage: com.ruoyi.**.domain
  mapperLocations: classpath*:mapper/**/*Mapper.xml
  configLocation: classpath:mybatis/mybatis-config.xml

# Swagger配置
swagger:
  enabled: true
  pathMapping: /dev-api
```

#### 数据源配置（application-druid.yml）
```yaml
spring:
  datasource:
    type: com.alibaba.druid.pool.DruidDataSource
    driverClassName: com.mysql.cj.jdbc.Driver
    druid:
      # 主库数据源
      master:
        url: jdbc:mysql://localhost:3306/db_pss?useUnicode=true&characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=true&serverTimezone=GMT%2B8
        username: root
        password: your_password
```

#### 前端配置（vue.config.js）
```javascript
const port = process.env.port || process.env.npm_config_port || 80

module.exports = {
  publicPath: process.env.NODE_ENV === "production" ? "/" : "/",
  outputDir: 'dist',
  assetsDir: 'static',
  devServer: {
    host: '0.0.0.0',
    port: port,
    open: true,
    proxy: {
      [process.env.VUE_APP_BASE_API]: {
        target: `http://localhost:11451`,
        changeOrigin: true,
        pathRewrite: {
          ['^' + process.env.VUE_APP_BASE_API]: ''
        }
      }
    }
  }
}
```

---

## 部署指南

### 本地开发环境部署

#### 1. 数据库初始化
```sql
-- 1. 创建数据库
CREATE DATABASE db_pss DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- 2. 执行SQL脚本
-- 执行 sql/db_pss.sql 文件（若依基础数据）
-- 执行 sql/flower_table.sql 文件（花卉表结构）
```

#### 2. 后端部署
```bash
# 1. 使用IDEA打开项目
# 2. 配置数据库连接（application-druid.yml）
# 3. 启动Redis服务
# 4. 运行 RuoYiApplication.java
# 5. 后端服务运行在 http://localhost:8080
```

#### 3. 前端部署
```bash
# 1. 进入前端目录
cd ruoyi-ui

# 2. 安装依赖
npm install
# 或使用国内镜像
npm install --registry=https://registry.npmmirror.com

# 3. 启动开发服务器
npm run dev

# 4. 访问 http://localhost:80
```

### 生产环境部署

#### 后端打包部署
```bash
# 1. 打包项目
mvn clean package

# 2. 生成jar包位置
# ruoyi-admin/target/ruoyi-admin.jar

# 3. 运行jar包
java -jar ruoyi-admin.jar

# 4. 或使用脚本启动
# Windows: bin/run.bat
# Linux: bin/run.sh
```

#### 前端打包部署
```bash
# 1. 构建生产环境
npm run build:prod

# 2. 生成dist目录
# 3. 将dist目录部署到Nginx或Tomcat
```

#### Nginx配置示例
```nginx
server {
    listen 80;
    server_name localhost;
    
    location / {
        root /path/to/dist;
        try_files $uri $uri/ /index.html;
    }
    
    location /dev-api {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
    
    # 图片访问路径
    location /profile {
        alias /path/to/uploadPath;
        expires 30d;
    }
}
```

---

## 使用说明

### 系统登录

#### 管理员账号
- **用户名**：admin
- **密码**：admin123

#### 普通用户账号
- **用户名**：ry
- **密码**：123456

### 核心功能使用

#### 1. 花卉信息管理
1. 进入"花卉管理" -> "花卉信息"
2. 点击"新增"按钮，填写花卉信息
   - 输入花卉名称和编码（编码需唯一）
   - 选择花卉类型（观花类/观叶类/观果类/多肉类）
   - 输入颜色、花期
   - 设置价格、库存量、预警值
   - 选择单位（盆/株/束等）
   - **上传花卉图片**（支持JPG、PNG格式）
   - 设置状态
3. 保存后可在列表中查看和管理
4. 列表页面可查看花卉图片缩略图

#### 2. 花卉购买（用户端）
1. 进入"花卉商城" -> "花卉购买"
2. 浏览花卉列表（带图片展示）
3. 可通过花卉名称、类型等条件筛选
4. 点击"购买"按钮
5. 在购买对话框中：
   - 选择购买数量（系统自动校验库存）
   - 选择收货地址
   - 查看金额汇总
6. 点击"确定购买"生成订单

#### 3. 订单管理
1. **我的订单**：查看当前用户的订单
   - 可查看订单详情
   - 可取消未完成的订单
   - 可标记订单为已完成
2. **全部订单**：管理员查看所有订单
   - 可按状态筛选
   - 可按用户、花卉名称搜索
   - 可查看订单统计

#### 4. 库存管理
1. 进入"花卉管理" -> "库存管理"
2. 查看所有花卉的库存情况
3. 库存低于预警值的花卉会高亮显示
4. 可查看库存统计信息

#### 5. 库存预警
1. 进入"花卉管理" -> "库存预警"
2. 查看所有需要预警的花卉（库存低于预警值）
3. 及时进行补货处理

#### 6. 数据统计
1. 进入"花卉管理" -> "数据报表"
2. 查看销售统计、库存统计等图表
3. 支持数据导出

### 权限管理

#### 角色权限配置
1. 进入"系统管理" -> "角色管理"
2. 选择角色，点击"修改"
3. 在"菜单权限"中勾选可访问的菜单
4. 在"权限字符"中配置按钮权限

#### 用户角色分配
1. 进入"系统管理" -> "用户管理"
2. 选择用户，点击"修改"
3. 在"角色"中选择用户角色

---

## 开发规范

### 代码规范

#### Java代码规范
- 遵循阿里巴巴Java开发手册
- 类名使用大驼峰命名（PascalCase）
- 方法名和变量名使用小驼峰命名（camelCase）
- 常量使用全大写下划线分隔（UPPER_SNAKE_CASE）
- 包名全小写，使用点分隔

#### 前端代码规范
- 遵循Vue.js官方风格指南
- 组件名使用PascalCase
- 文件名使用kebab-case
- 使用ESLint进行代码检查

### 数据库规范

#### 命名规范
- 表名使用小写下划线分隔（snake_case）
- 字段名使用小写下划线分隔
- 主键统一使用 `表名_id` 格式
- 外键使用 `关联表名_id` 格式

#### 字段规范
- 每个表必须包含以下字段：
  - `create_by`：创建者
  - `create_time`：创建时间
  - `update_by`：更新者
  - `update_time`：更新时间
  - `remark`：备注

### API接口规范

#### RESTful API设计
- GET：查询数据
- POST：新增数据
- PUT：更新数据
- DELETE：删除数据

#### 统一响应格式
```json
{
  "code": 200,
  "msg": "操作成功",
  "data": {}
}
```

#### 错误码规范
- 200：操作成功
- 401：未登录
- 403：无权限
- 500：服务器错误

### 图片管理规范

#### 图片上传
- 支持格式：JPG、PNG、GIF
- 最大文件大小：10MB
- 存储路径：`/profile/upload/年/月/日/文件名`
- 图片命名：使用时间戳+随机数

#### 图片显示
- 列表页：使用缩略图（50x50）
- 详情页：使用原图
- 使用`ImagePreview`组件实现图片预览

---

## 常见问题

### 1. 后端启动失败

#### 问题：数据库连接失败
**解决方案**：
- 检查MySQL服务是否启动
- 检查数据库连接配置（application-druid.yml）
- 确认数据库名称、用户名、密码是否正确
- 确认数据库是否已创建

#### 问题：Redis连接失败
**解决方案**：
- 检查Redis服务是否启动
- 检查Redis配置（application.yml）
- 确认Redis密码是否正确

### 2. 前端启动失败

#### 问题：npm install 失败
**解决方案**：
- 使用国内镜像：`npm install --registry=https://registry.npmmirror.com`
- 清除npm缓存：`npm cache clean --force`
- 删除node_modules和package-lock.json后重新安装

#### 问题：端口被占用
**解决方案**：
- 修改vue.config.js中的port配置
- 或使用命令：`npm run dev -- --port 8081`

### 3. 功能问题

#### 问题：图片上传失败
**解决方案**：
- 检查文件上传路径配置（ruoyi.profile）
- 确认上传目录有写入权限
- 检查文件大小是否超过限制
- 检查文件格式是否支持

#### 问题：图片无法显示
**解决方案**：
- 检查图片路径是否正确
- 检查Nginx配置（生产环境）
- 确认图片文件是否存在
- 检查跨域配置

#### 问题：订单创建失败
**解决方案**：
- 检查花卉库存是否充足
- 检查数据库外键约束
- 查看后端日志错误信息
- 检查用户余额是否充足

### 4. 性能问题

#### 问题：页面加载缓慢
**解决方案**：
- 检查Redis缓存是否正常
- 优化数据库查询语句
- 使用分页查询
- 前端使用懒加载
- 图片使用缩略图

#### 问题：数据库查询慢
**解决方案**：
- 添加数据库索引
- 优化SQL语句
- 使用Redis缓存热点数据

---

## 附录

### 项目文件说明

#### 启动脚本
- `bin/run.bat`：Windows启动脚本
- `bin/run.sh`：Linux启动脚本
- `bin/package.bat`：Windows打包脚本
- `bin/clean.bat`：Windows清理脚本

#### 数据库脚本
- `sql/db_pss.sql`：主数据库脚本
- `sql/flower_table.sql`：花卉表结构脚本
- `ruoyi/sql/ry_20191008.sql`：若依框架基础数据

### 技术支持

#### 相关文档
- 若依框架文档：http://doc.ruoyi.vip
- Vue.js文档：https://cn.vuejs.org
- Element-UI文档：https://element.eleme.cn

#### 联系方式
- 项目作者：唐顺
- 项目仓库：https://github.com/6ts66/tang.github.io

---

## 更新日志

### Version 1.0.0（2025-01-01）
- 基于若依框架3.8.5版本
- 实现花卉信息管理功能
- 集成图片上传和管理功能
- 实现花卉购买商城功能
- 实现订单管理功能
- 实现库存管理和预警功能
- 实现数据统计报表功能

---

**文档生成时间**：2025年1月1日
**文档版本**：1.0.0
**最后更新**：2025年1月1日

