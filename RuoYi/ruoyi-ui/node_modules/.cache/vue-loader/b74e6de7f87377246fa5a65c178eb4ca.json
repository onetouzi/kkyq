{"remainingRequest":"C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\src\\views\\pill\\flowerClient\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\src\\views\\pill\\flowerClient\\index.vue","mtime":1767595370500},{"path":"C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1767595575517},{"path":"C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1767595575519},{"path":"C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1767595575517},{"path":"C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1767595573878}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBsaXN0Rmxvd2VyQ2xpZW50LCBidXlGbG93ZXJzIH0gZnJvbSAnQC9hcGkvcGlsbC9mbG93ZXJDbGllbnQnDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ0Zsb3dlckNsaWVudCcsDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGxvYWRpbmc6IGZhbHNlLA0KICAgICAgbGlzdDogW10sDQogICAgICB0b3RhbDogMCwNCiAgICAgIHF1ZXJ5UGFyYW1zOiB7DQogICAgICAgIHBhZ2VOdW06IDEsDQogICAgICAgIHBhZ2VTaXplOiAxMCwNCiAgICAgICAgZmxvd2VyTmFtZTogdW5kZWZpbmVkLA0KICAgICAgICBmbG93ZXJUeXBlOiB1bmRlZmluZWQNCiAgICAgIH0sDQogICAgICBidXlPcGVuOiBmYWxzZSwNCiAgICAgIGJ1eUZvcm06IHsNCiAgICAgICAgZmxvd2VySWQ6IHVuZGVmaW5lZCwNCiAgICAgICAgZmxvd2VyTmFtZTogJycsDQogICAgICAgIHByaWNlOiAwLA0KICAgICAgICBxdWFudGl0eTogMSwNCiAgICAgICAgbWF4OiAwDQogICAgICB9DQogICAgfQ0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIHRoaXMuZ2V0TGlzdCgpDQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBnZXRMaXN0KCkgew0KICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQ0KICAgICAgbGlzdEZsb3dlckNsaWVudCh0aGlzLnF1ZXJ5UGFyYW1zKS50aGVuKHJlcyA9PiB7DQogICAgICAgIHRoaXMubGlzdCA9IHJlcy5yb3dzIHx8IFtdDQogICAgICAgIHRoaXMudG90YWwgPSByZXMudG90YWwgfHwgMA0KICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgfSkuY2F0Y2goKCkgPT4gew0KICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgfSkNCiAgICB9LA0KICAgIGhhbmRsZVF1ZXJ5KCkgew0KICAgICAgdGhpcy5xdWVyeVBhcmFtcy5wYWdlTnVtID0gMQ0KICAgICAgdGhpcy5nZXRMaXN0KCkNCiAgICB9LA0KICAgIHJlc2V0UXVlcnkoKSB7DQogICAgICB0aGlzLnF1ZXJ5UGFyYW1zID0gew0KICAgICAgICBwYWdlTnVtOiAxLA0KICAgICAgICBwYWdlU2l6ZTogMTAsDQogICAgICAgIGZsb3dlck5hbWU6IHVuZGVmaW5lZCwNCiAgICAgICAgZmxvd2VyVHlwZTogdW5kZWZpbmVkDQogICAgICB9DQogICAgICB0aGlzLmdldExpc3QoKQ0KICAgIH0sDQogICAgaGFuZGxlQ3VycmVudENoYW5nZSh2YWwpIHsNCiAgICAgIHRoaXMucXVlcnlQYXJhbXMucGFnZU51bSA9IHZhbA0KICAgICAgdGhpcy5nZXRMaXN0KCkNCiAgICB9LA0KICAgIG9wZW5CdXlEaWFsb2coaXRlbSkgew0KICAgICAgdGhpcy5idXlGb3JtID0gew0KICAgICAgICBmbG93ZXJJZDogaXRlbS5mbG93ZXJJZCwNCiAgICAgICAgZmxvd2VyTmFtZTogaXRlbS5mbG93ZXJOYW1lLA0KICAgICAgICBwcmljZTogaXRlbS5wcmljZSwNCiAgICAgICAgcXVhbnRpdHk6IDEsDQogICAgICAgIG1heDogaXRlbS5udW0NCiAgICAgIH0NCiAgICAgIHRoaXMuYnV5T3BlbiA9IHRydWUNCiAgICB9LA0KICAgIHN1Ym1pdEJ1eSgpIHsNCiAgICAgIGlmICh0aGlzLmJ1eUZvcm0ucXVhbnRpdHkgPD0gMCkgew0KICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+aVsOmHj+W/hemhu+Wkp+S6jiAwJykNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgICBpZiAodGhpcy5idXlGb3JtLnF1YW50aXR5ID4gdGhpcy5idXlGb3JtLm1heCkgew0KICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+i0reS5sOaVsOmHj+S4jeiDvei2hei/h+W6k+WtmCcpDQogICAgICAgIHJldHVybg0KICAgICAgfQ0KICAgICAgY29uc3QgcGF5bG9hZCA9IFsNCiAgICAgICAgew0KICAgICAgICAgIGZsb3dlcklkOiB0aGlzLmJ1eUZvcm0uZmxvd2VySWQsDQogICAgICAgICAgZmxvd2VyTmFtZTogdGhpcy5idXlGb3JtLmZsb3dlck5hbWUsDQogICAgICAgICAgcXVhbnRpdHk6IHRoaXMuYnV5Rm9ybS5xdWFudGl0eSwNCiAgICAgICAgICBwcmljZTogdGhpcy5idXlGb3JtLnByaWNlDQogICAgICAgIH0NCiAgICAgIF0NCiAgICAgIGJ1eUZsb3dlcnMocGF5bG9hZCkudGhlbigoKSA9PiB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn6LSt5Lmw5oiQ5YqfJykNCiAgICAgICAgdGhpcy5idXlPcGVuID0gZmFsc2UNCiAgICAgICAgdGhpcy5nZXRMaXN0KCkNCiAgICAgIH0pDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAkGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/pill/flowerClient","sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <div class=\"filter-container\">\r\n      <el-form :inline=\"true\" :model=\"queryParams\" size=\"small\">\r\n        <el-form-item label=\"名称\">\r\n          <el-input\r\n            v-model=\"queryParams.flowerName\"\r\n            placeholder=\"花卉名称\"\r\n            clearable\r\n            @keyup.enter.native=\"handleQuery\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"类型\">\r\n          <el-select v-model=\"queryParams.flowerType\" placeholder=\"请选择类型\" clearable>\r\n            <el-option label=\"观花类\" value=\"0\" />\r\n            <el-option label=\"观叶类\" value=\"1\" />\r\n            <el-option label=\"观果类\" value=\"2\" />\r\n            <el-option label=\"多肉类\" value=\"3\" />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"handleQuery\">搜索</el-button>\r\n          <el-button icon=\"el-icon-refresh\" @click=\"resetQuery\">重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n\r\n    <el-row :gutter=\"20\">\r\n      <el-col\r\n        v-for=\"item in list\"\r\n        :key=\"item.flowerId\"\r\n        :xs=\"24\"\r\n        :sm=\"12\"\r\n        :md=\"8\"\r\n        :lg=\"6\"\r\n      >\r\n        <el-card class=\"flower-card\" shadow=\"hover\">\r\n          <el-image\r\n            v-if=\"item.image\"\r\n            :src=\"item.image\"\r\n            :preview-src-list=\"[item.image]\"\r\n            style=\"width: 100%; height: 180px\"\r\n            fit=\"cover\"\r\n          />\r\n          <div class=\"info\">\r\n            <div class=\"name\">{{ item.flowerName }}</div>\r\n            <div class=\"price\">￥{{ item.price }} / {{ item.unit || '件' }}</div>\r\n            <div class=\"stock\">库存：{{ item.num }}</div>\r\n          </div>\r\n          <div class=\"actions\">\r\n            <el-button type=\"primary\" size=\"mini\" @click=\"openBuyDialog(item)\">\r\n              购买\r\n            </el-button>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <el-pagination\r\n      v-show=\"total > 0\"\r\n      style=\"margin-top: 10px; text-align: right\"\r\n      background\r\n      layout=\"total, prev, pager, next\"\r\n      :total=\"total\"\r\n      :page-size=\"queryParams.pageSize\"\r\n      :current-page=\"queryParams.pageNum\"\r\n      @current-change=\"handleCurrentChange\"\r\n    />\r\n\r\n    <el-dialog title=\"购买花卉\" :visible.sync=\"buyOpen\" width=\"400px\">\r\n      <el-form :model=\"buyForm\" label-width=\"90px\">\r\n        <el-form-item label=\"花卉\">\r\n          <span>{{ buyForm.flowerName }}</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"单价\">\r\n          <span>￥{{ buyForm.price }}</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"数量\">\r\n          <el-input-number v-model=\"buyForm.quantity\" :min=\"1\" :max=\"buyForm.max\" />\r\n          <div style=\"font-size: 12px; color: #999; margin-top: 4px\">\r\n            当前库存：{{ buyForm.max }}\r\n          </div>\r\n        </el-form-item>\r\n        <el-form-item label=\"总金额\">\r\n          <span style=\"color: #f56c6c; font-weight: bold\">\r\n            ￥{{ buyForm.price * buyForm.quantity }}\r\n          </span>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"buyOpen = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"submitBuy\">确认购买</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { listFlowerClient, buyFlowers } from '@/api/pill/flowerClient'\r\n\r\nexport default {\r\n  name: 'FlowerClient',\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      list: [],\r\n      total: 0,\r\n      queryParams: {\r\n        pageNum: 1,\r\n        pageSize: 10,\r\n        flowerName: undefined,\r\n        flowerType: undefined\r\n      },\r\n      buyOpen: false,\r\n      buyForm: {\r\n        flowerId: undefined,\r\n        flowerName: '',\r\n        price: 0,\r\n        quantity: 1,\r\n        max: 0\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.getList()\r\n  },\r\n  methods: {\r\n    getList() {\r\n      this.loading = true\r\n      listFlowerClient(this.queryParams).then(res => {\r\n        this.list = res.rows || []\r\n        this.total = res.total || 0\r\n        this.loading = false\r\n      }).catch(() => {\r\n        this.loading = false\r\n      })\r\n    },\r\n    handleQuery() {\r\n      this.queryParams.pageNum = 1\r\n      this.getList()\r\n    },\r\n    resetQuery() {\r\n      this.queryParams = {\r\n        pageNum: 1,\r\n        pageSize: 10,\r\n        flowerName: undefined,\r\n        flowerType: undefined\r\n      }\r\n      this.getList()\r\n    },\r\n    handleCurrentChange(val) {\r\n      this.queryParams.pageNum = val\r\n      this.getList()\r\n    },\r\n    openBuyDialog(item) {\r\n      this.buyForm = {\r\n        flowerId: item.flowerId,\r\n        flowerName: item.flowerName,\r\n        price: item.price,\r\n        quantity: 1,\r\n        max: item.num\r\n      }\r\n      this.buyOpen = true\r\n    },\r\n    submitBuy() {\r\n      if (this.buyForm.quantity <= 0) {\r\n        this.$message.warning('数量必须大于 0')\r\n        return\r\n      }\r\n      if (this.buyForm.quantity > this.buyForm.max) {\r\n        this.$message.warning('购买数量不能超过库存')\r\n        return\r\n      }\r\n      const payload = [\r\n        {\r\n          flowerId: this.buyForm.flowerId,\r\n          flowerName: this.buyForm.flowerName,\r\n          quantity: this.buyForm.quantity,\r\n          price: this.buyForm.price\r\n        }\r\n      ]\r\n      buyFlowers(payload).then(() => {\r\n        this.$message.success('购买成功')\r\n        this.buyOpen = false\r\n        this.getList()\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.flower-card {\r\n  margin-bottom: 20px;\r\n}\r\n.info {\r\n  margin-top: 10px;\r\n}\r\n.name {\r\n  font-weight: bold;\r\n  margin-bottom: 4px;\r\n}\r\n.price {\r\n  color: #f56c6c;\r\n}\r\n.stock {\r\n  font-size: 12px;\r\n  color: #999;\r\n}\r\n.actions {\r\n  margin-top: 10px;\r\n  text-align: right;\r\n}\r\n</style>\r\n\r\n\r\n"]}]}