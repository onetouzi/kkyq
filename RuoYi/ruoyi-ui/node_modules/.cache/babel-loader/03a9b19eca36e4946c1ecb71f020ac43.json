{"remainingRequest":"C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\node_modules\\babel-loader\\lib\\index.js!C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\src\\views\\pill\\flowerClient\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\src\\views\\pill\\flowerClient\\index.vue","mtime":1767595370500},{"path":"C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1767595575517},{"path":"C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1767595575519},{"path":"C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1767595575517},{"path":"C:\\ruoyi\\kkyq-rebuild - 副本\\RuoYi\\ruoyi-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1767595573878}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgbGlzdEZsb3dlckNsaWVudCwgYnV5Rmxvd2VycyB9IGZyb20gJ0AvYXBpL3BpbGwvZmxvd2VyQ2xpZW50JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdGbG93ZXJDbGllbnQnLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgbGlzdDogW10sCiAgICAgIHRvdGFsOiAwLAogICAgICBxdWVyeVBhcmFtczogewogICAgICAgIHBhZ2VOdW06IDEsCiAgICAgICAgcGFnZVNpemU6IDEwLAogICAgICAgIGZsb3dlck5hbWU6IHVuZGVmaW5lZCwKICAgICAgICBmbG93ZXJUeXBlOiB1bmRlZmluZWQKICAgICAgfSwKICAgICAgYnV5T3BlbjogZmFsc2UsCiAgICAgIGJ1eUZvcm06IHsKICAgICAgICBmbG93ZXJJZDogdW5kZWZpbmVkLAogICAgICAgIGZsb3dlck5hbWU6ICcnLAogICAgICAgIHByaWNlOiAwLAogICAgICAgIHF1YW50aXR5OiAxLAogICAgICAgIG1heDogMAogICAgICB9CiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0TGlzdCgpOwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0TGlzdCgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgbGlzdEZsb3dlckNsaWVudCh0aGlzLnF1ZXJ5UGFyYW1zKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5saXN0ID0gcmVzLnJvd3MgfHwgW107CiAgICAgICAgdGhpcy50b3RhbCA9IHJlcy50b3RhbCB8fCAwOwogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIH0pOwogICAgfSwKICAgIGhhbmRsZVF1ZXJ5KCkgewogICAgICB0aGlzLnF1ZXJ5UGFyYW1zLnBhZ2VOdW0gPSAxOwogICAgICB0aGlzLmdldExpc3QoKTsKICAgIH0sCiAgICByZXNldFF1ZXJ5KCkgewogICAgICB0aGlzLnF1ZXJ5UGFyYW1zID0gewogICAgICAgIHBhZ2VOdW06IDEsCiAgICAgICAgcGFnZVNpemU6IDEwLAogICAgICAgIGZsb3dlck5hbWU6IHVuZGVmaW5lZCwKICAgICAgICBmbG93ZXJUeXBlOiB1bmRlZmluZWQKICAgICAgfTsKICAgICAgdGhpcy5nZXRMaXN0KCk7CiAgICB9LAogICAgaGFuZGxlQ3VycmVudENoYW5nZSh2YWwpIHsKICAgICAgdGhpcy5xdWVyeVBhcmFtcy5wYWdlTnVtID0gdmFsOwogICAgICB0aGlzLmdldExpc3QoKTsKICAgIH0sCiAgICBvcGVuQnV5RGlhbG9nKGl0ZW0pIHsKICAgICAgdGhpcy5idXlGb3JtID0gewogICAgICAgIGZsb3dlcklkOiBpdGVtLmZsb3dlcklkLAogICAgICAgIGZsb3dlck5hbWU6IGl0ZW0uZmxvd2VyTmFtZSwKICAgICAgICBwcmljZTogaXRlbS5wcmljZSwKICAgICAgICBxdWFudGl0eTogMSwKICAgICAgICBtYXg6IGl0ZW0ubnVtCiAgICAgIH07CiAgICAgIHRoaXMuYnV5T3BlbiA9IHRydWU7CiAgICB9LAogICAgc3VibWl0QnV5KCkgewogICAgICBpZiAodGhpcy5idXlGb3JtLnF1YW50aXR5IDw9IDApIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+aVsOmHj+W/hemhu+Wkp+S6jiAwJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICh0aGlzLmJ1eUZvcm0ucXVhbnRpdHkgPiB0aGlzLmJ1eUZvcm0ubWF4KSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfotK3kubDmlbDph4/kuI3og73otoXov4flupPlrZgnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgY29uc3QgcGF5bG9hZCA9IFt7CiAgICAgICAgZmxvd2VySWQ6IHRoaXMuYnV5Rm9ybS5mbG93ZXJJZCwKICAgICAgICBmbG93ZXJOYW1lOiB0aGlzLmJ1eUZvcm0uZmxvd2VyTmFtZSwKICAgICAgICBxdWFudGl0eTogdGhpcy5idXlGb3JtLnF1YW50aXR5LAogICAgICAgIHByaWNlOiB0aGlzLmJ1eUZvcm0ucHJpY2UKICAgICAgfV07CiAgICAgIGJ1eUZsb3dlcnMocGF5bG9hZCkudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfotK3kubDmiJDlip8nKTsKICAgICAgICB0aGlzLmJ1eU9wZW4gPSBmYWxzZTsKICAgICAgICB0aGlzLmdldExpc3QoKTsKICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["listFlowerClient","buyFlowers","name","data","loading","list","total","queryParams","pageNum","pageSize","flowerName","undefined","flowerType","buyOpen","buyForm","flowerId","price","quantity","max","created","getList","methods","then","res","rows","catch","handleQuery","resetQuery","handleCurrentChange","val","openBuyDialog","item","num","submitBuy","$message","warning","payload","success"],"sources":["src/views/pill/flowerClient/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <div class=\"filter-container\">\r\n      <el-form :inline=\"true\" :model=\"queryParams\" size=\"small\">\r\n        <el-form-item label=\"名称\">\r\n          <el-input\r\n            v-model=\"queryParams.flowerName\"\r\n            placeholder=\"花卉名称\"\r\n            clearable\r\n            @keyup.enter.native=\"handleQuery\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"类型\">\r\n          <el-select v-model=\"queryParams.flowerType\" placeholder=\"请选择类型\" clearable>\r\n            <el-option label=\"观花类\" value=\"0\" />\r\n            <el-option label=\"观叶类\" value=\"1\" />\r\n            <el-option label=\"观果类\" value=\"2\" />\r\n            <el-option label=\"多肉类\" value=\"3\" />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"handleQuery\">搜索</el-button>\r\n          <el-button icon=\"el-icon-refresh\" @click=\"resetQuery\">重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n\r\n    <el-row :gutter=\"20\">\r\n      <el-col\r\n        v-for=\"item in list\"\r\n        :key=\"item.flowerId\"\r\n        :xs=\"24\"\r\n        :sm=\"12\"\r\n        :md=\"8\"\r\n        :lg=\"6\"\r\n      >\r\n        <el-card class=\"flower-card\" shadow=\"hover\">\r\n          <el-image\r\n            v-if=\"item.image\"\r\n            :src=\"item.image\"\r\n            :preview-src-list=\"[item.image]\"\r\n            style=\"width: 100%; height: 180px\"\r\n            fit=\"cover\"\r\n          />\r\n          <div class=\"info\">\r\n            <div class=\"name\">{{ item.flowerName }}</div>\r\n            <div class=\"price\">￥{{ item.price }} / {{ item.unit || '件' }}</div>\r\n            <div class=\"stock\">库存：{{ item.num }}</div>\r\n          </div>\r\n          <div class=\"actions\">\r\n            <el-button type=\"primary\" size=\"mini\" @click=\"openBuyDialog(item)\">\r\n              购买\r\n            </el-button>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <el-pagination\r\n      v-show=\"total > 0\"\r\n      style=\"margin-top: 10px; text-align: right\"\r\n      background\r\n      layout=\"total, prev, pager, next\"\r\n      :total=\"total\"\r\n      :page-size=\"queryParams.pageSize\"\r\n      :current-page=\"queryParams.pageNum\"\r\n      @current-change=\"handleCurrentChange\"\r\n    />\r\n\r\n    <el-dialog title=\"购买花卉\" :visible.sync=\"buyOpen\" width=\"400px\">\r\n      <el-form :model=\"buyForm\" label-width=\"90px\">\r\n        <el-form-item label=\"花卉\">\r\n          <span>{{ buyForm.flowerName }}</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"单价\">\r\n          <span>￥{{ buyForm.price }}</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"数量\">\r\n          <el-input-number v-model=\"buyForm.quantity\" :min=\"1\" :max=\"buyForm.max\" />\r\n          <div style=\"font-size: 12px; color: #999; margin-top: 4px\">\r\n            当前库存：{{ buyForm.max }}\r\n          </div>\r\n        </el-form-item>\r\n        <el-form-item label=\"总金额\">\r\n          <span style=\"color: #f56c6c; font-weight: bold\">\r\n            ￥{{ buyForm.price * buyForm.quantity }}\r\n          </span>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"buyOpen = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"submitBuy\">确认购买</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { listFlowerClient, buyFlowers } from '@/api/pill/flowerClient'\r\n\r\nexport default {\r\n  name: 'FlowerClient',\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      list: [],\r\n      total: 0,\r\n      queryParams: {\r\n        pageNum: 1,\r\n        pageSize: 10,\r\n        flowerName: undefined,\r\n        flowerType: undefined\r\n      },\r\n      buyOpen: false,\r\n      buyForm: {\r\n        flowerId: undefined,\r\n        flowerName: '',\r\n        price: 0,\r\n        quantity: 1,\r\n        max: 0\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.getList()\r\n  },\r\n  methods: {\r\n    getList() {\r\n      this.loading = true\r\n      listFlowerClient(this.queryParams).then(res => {\r\n        this.list = res.rows || []\r\n        this.total = res.total || 0\r\n        this.loading = false\r\n      }).catch(() => {\r\n        this.loading = false\r\n      })\r\n    },\r\n    handleQuery() {\r\n      this.queryParams.pageNum = 1\r\n      this.getList()\r\n    },\r\n    resetQuery() {\r\n      this.queryParams = {\r\n        pageNum: 1,\r\n        pageSize: 10,\r\n        flowerName: undefined,\r\n        flowerType: undefined\r\n      }\r\n      this.getList()\r\n    },\r\n    handleCurrentChange(val) {\r\n      this.queryParams.pageNum = val\r\n      this.getList()\r\n    },\r\n    openBuyDialog(item) {\r\n      this.buyForm = {\r\n        flowerId: item.flowerId,\r\n        flowerName: item.flowerName,\r\n        price: item.price,\r\n        quantity: 1,\r\n        max: item.num\r\n      }\r\n      this.buyOpen = true\r\n    },\r\n    submitBuy() {\r\n      if (this.buyForm.quantity <= 0) {\r\n        this.$message.warning('数量必须大于 0')\r\n        return\r\n      }\r\n      if (this.buyForm.quantity > this.buyForm.max) {\r\n        this.$message.warning('购买数量不能超过库存')\r\n        return\r\n      }\r\n      const payload = [\r\n        {\r\n          flowerId: this.buyForm.flowerId,\r\n          flowerName: this.buyForm.flowerName,\r\n          quantity: this.buyForm.quantity,\r\n          price: this.buyForm.price\r\n        }\r\n      ]\r\n      buyFlowers(payload).then(() => {\r\n        this.$message.success('购买成功')\r\n        this.buyOpen = false\r\n        this.getList()\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.flower-card {\r\n  margin-bottom: 20px;\r\n}\r\n.info {\r\n  margin-top: 10px;\r\n}\r\n.name {\r\n  font-weight: bold;\r\n  margin-bottom: 4px;\r\n}\r\n.price {\r\n  color: #f56c6c;\r\n}\r\n.stock {\r\n  font-size: 12px;\r\n  color: #999;\r\n}\r\n.actions {\r\n  margin-top: 10px;\r\n  text-align: right;\r\n}\r\n</style>\r\n\r\n\r\n"],"mappings":"AAkGA,SAAAA,gBAAA,EAAAC,UAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,OAAA;MACAC,IAAA;MACAC,KAAA;MACAC,WAAA;QACAC,OAAA;QACAC,QAAA;QACAC,UAAA,EAAAC,SAAA;QACAC,UAAA,EAAAD;MACA;MACAE,OAAA;MACAC,OAAA;QACAC,QAAA,EAAAJ,SAAA;QACAD,UAAA;QACAM,KAAA;QACAC,QAAA;QACAC,GAAA;MACA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,OAAA;EACA;EACAC,OAAA;IACAD,QAAA;MACA,KAAAhB,OAAA;MACAJ,gBAAA,MAAAO,WAAA,EAAAe,IAAA,CAAAC,GAAA;QACA,KAAAlB,IAAA,GAAAkB,GAAA,CAAAC,IAAA;QACA,KAAAlB,KAAA,GAAAiB,GAAA,CAAAjB,KAAA;QACA,KAAAF,OAAA;MACA,GAAAqB,KAAA;QACA,KAAArB,OAAA;MACA;IACA;IACAsB,YAAA;MACA,KAAAnB,WAAA,CAAAC,OAAA;MACA,KAAAY,OAAA;IACA;IACAO,WAAA;MACA,KAAApB,WAAA;QACAC,OAAA;QACAC,QAAA;QACAC,UAAA,EAAAC,SAAA;QACAC,UAAA,EAAAD;MACA;MACA,KAAAS,OAAA;IACA;IACAQ,oBAAAC,GAAA;MACA,KAAAtB,WAAA,CAAAC,OAAA,GAAAqB,GAAA;MACA,KAAAT,OAAA;IACA;IACAU,cAAAC,IAAA;MACA,KAAAjB,OAAA;QACAC,QAAA,EAAAgB,IAAA,CAAAhB,QAAA;QACAL,UAAA,EAAAqB,IAAA,CAAArB,UAAA;QACAM,KAAA,EAAAe,IAAA,CAAAf,KAAA;QACAC,QAAA;QACAC,GAAA,EAAAa,IAAA,CAAAC;MACA;MACA,KAAAnB,OAAA;IACA;IACAoB,UAAA;MACA,SAAAnB,OAAA,CAAAG,QAAA;QACA,KAAAiB,QAAA,CAAAC,OAAA;QACA;MACA;MACA,SAAArB,OAAA,CAAAG,QAAA,QAAAH,OAAA,CAAAI,GAAA;QACA,KAAAgB,QAAA,CAAAC,OAAA;QACA;MACA;MACA,MAAAC,OAAA,IACA;QACArB,QAAA,OAAAD,OAAA,CAAAC,QAAA;QACAL,UAAA,OAAAI,OAAA,CAAAJ,UAAA;QACAO,QAAA,OAAAH,OAAA,CAAAG,QAAA;QACAD,KAAA,OAAAF,OAAA,CAAAE;MACA,EACA;MACAf,UAAA,CAAAmC,OAAA,EAAAd,IAAA;QACA,KAAAY,QAAA,CAAAG,OAAA;QACA,KAAAxB,OAAA;QACA,KAAAO,OAAA;MACA;IACA;EACA;AACA","ignoreList":[]}]}